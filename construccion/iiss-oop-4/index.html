



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Apuntes de Implementación e Implantación de Sistemas Software – Grado en Ingeniería Informática">
      
      
      
        <meta name="author" content="Juan Manuel Dodero">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>Duplicación - Implementación e Implantación de Sistemas Software</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.adb8469c.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#caso-4-calculo-de-nominas" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Implementación e Implantación de Sistemas Software" aria-label="Implementación e Implantación de Sistemas Software" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Implementación e Implantación de Sistemas Software
            </span>
            <span class="md-header-nav__topic">
              
                Duplicación
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/sistemas-sw/construccion/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Implementación e Implantación de Sistemas Software" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Implementación e Implantación de Sistemas Software
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/sistemas-sw/construccion/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Inicio" class="md-nav__link">
      Inicio
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Asignatura
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Asignatura
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../iiss-pres/" title="Presentación" class="md-nav__link">
      Presentación
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bibliografia/" title="Bibliografía" class="md-nav__link">
      Bibliografía
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../about/" title="About" class="md-nav__link">
      About
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../iiss-temas/" title="Temario" class="md-nav__link">
      Temario
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      I. Objetos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        I. Objetos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../iiss-oop-1/" title="Principios" class="md-nav__link">
      Principios
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../iiss-oop-2/" title="Delegación" class="md-nav__link">
      Delegación
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../iiss-oop-3/" title="Inyección" class="md-nav__link">
      Inyección
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Duplicación
      </label>
    
    <a href="./" title="Duplicación" class="md-nav__link md-nav__link--active">
      Duplicación
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#codigo-duplicado" class="md-nav__link">
    Código duplicado
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementacion-de-nominas-v01" class="md-nav__link">
    Implementación de nóminas v0.1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nominas-v02" class="md-nav__link">
    Nóminas v0.2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nominas-v03" class="md-nav__link">
    Nóminas v0.3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#refactoring" class="md-nav__link">
    Refactoring
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motivos-para-refactoring" class="md-nav__link">
    Motivos para refactoring
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codigo-duplicado_1" class="md-nav__link">
    Código duplicado
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#por-que-no-duplicar" class="md-nav__link">
    ¿Por qué no duplicar?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causas-de-la-duplicacion" class="md-nav__link">
    Causas de la duplicación
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#principio-dry-dont-repeat-yourself" class="md-nav__link">
    Principio DRY – Don't Repeat Yourself!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#duplicacion-impuesta" class="md-nav__link">
    Duplicación impuesta
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tecnicas-de-solucion" class="md-nav__link">
    Técnicas de solución
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#duplicacion-inadvertida" class="md-nav__link">
    Duplicación inadvertida
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejemplo-codigo-duplicado-version-1" class="md-nav__link">
    Ejemplo: código duplicado – versión 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejemplo-aplicando-memoization-version-2" class="md-nav__link">
    Ejemplo: aplicando memoization – versión 2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#principio-de-acceso-uniforme" class="md-nav__link">
    Principio de acceso uniforme
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejemplo-acceso-uniforme-en-c-version-3" class="md-nav__link">
    Ejemplo: acceso uniforme en C# – versión 3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejemplo-acceso-uniforme-en-scala" class="md-nav__link">
    Ejemplo: acceso uniforme en Scala
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#duplicacion-por-impaciencia" class="md-nav__link">
    Duplicación por impaciencia
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#duplicacion-por-simultaneidad" class="md-nav__link">
    Duplicación por simultaneidad
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ortogonalidad" class="md-nav__link">
    Ortogonalidad
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#beneficios-de-la-ortogonalidad" class="md-nav__link">
    Beneficios de la ortogonalidad
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mayor-productividad" class="md-nav__link">
    Mayor productividad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#menor-riesgo" class="md-nav__link">
    Menor riesgo
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#niveles-de-aplicacion-de-la-ortogonalizad" class="md-nav__link">
    Niveles de aplicación de la ortogonalizad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tecnicas-de-codificacion" class="md-nav__link">
    Técnicas de codificación
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#desacoplar-ley-de-demeter" class="md-nav__link">
    Desacoplar - ley de Demeter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inyectar-el-contexto" class="md-nav__link">
    Inyectar el contexto
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejemplo-patron-estrategia" class="md-nav__link">
    Ejemplo: patrón estrategia
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejemplo-caballeros-de-la-mesa-redonda" class="md-nav__link">
    Ejemplo: caballeros de la mesa redonda
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ley-de-demeter-para-funciones" class="md-nav__link">
    Ley de Demeter para funciones
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interfaces-fluent" class="md-nav__link">
    Interfaces fluent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#criticas-a-la-ley-de-demeter" class="md-nav__link">
    Críticas a la ley de Demeter
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejemplo-pintar-graficos-de-grabadoras" class="md-nav__link">
    Ejemplo: pintar gráficos de grabadoras
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#criticas" class="md-nav__link">
    Críticas
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ortogonalidad-en-toolkits-y-bibliotecas" class="md-nav__link">
    Ortogonalidad en toolkits y bibliotecas
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../iiss-err/" title="Calidad" class="md-nav__link">
      Calidad
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../iiss-aop/" title="II. Aspectos" class="md-nav__link">
      II. Aspectos
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../iiss-dbc/" title="III. Contratos" class="md-nav__link">
      III. Contratos
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      IV. Funciones
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        IV. Funciones
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../iiss-fp-1/" title="Interfaces funcionales" class="md-nav__link">
      Interfaces funcionales
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../iiss-fp-2/" title="Lambdas" class="md-nav__link">
      Lambdas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../iiss-fp-3/" title="Mixins" class="md-nav__link">
      Mixins
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      V. Eventos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        V. Eventos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../iiss-evp-1/" title="Listeners" class="md-nav__link">
      Listeners
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../iiss-evp-2/" title="Asíncronas" class="md-nav__link">
      Asíncronas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../iiss-evp-3/" title="Eventos" class="md-nav__link">
      Eventos
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#codigo-duplicado" class="md-nav__link">
    Código duplicado
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementacion-de-nominas-v01" class="md-nav__link">
    Implementación de nóminas v0.1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nominas-v02" class="md-nav__link">
    Nóminas v0.2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nominas-v03" class="md-nav__link">
    Nóminas v0.3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#refactoring" class="md-nav__link">
    Refactoring
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motivos-para-refactoring" class="md-nav__link">
    Motivos para refactoring
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codigo-duplicado_1" class="md-nav__link">
    Código duplicado
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#por-que-no-duplicar" class="md-nav__link">
    ¿Por qué no duplicar?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causas-de-la-duplicacion" class="md-nav__link">
    Causas de la duplicación
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#principio-dry-dont-repeat-yourself" class="md-nav__link">
    Principio DRY – Don't Repeat Yourself!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#duplicacion-impuesta" class="md-nav__link">
    Duplicación impuesta
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tecnicas-de-solucion" class="md-nav__link">
    Técnicas de solución
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#duplicacion-inadvertida" class="md-nav__link">
    Duplicación inadvertida
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejemplo-codigo-duplicado-version-1" class="md-nav__link">
    Ejemplo: código duplicado – versión 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejemplo-aplicando-memoization-version-2" class="md-nav__link">
    Ejemplo: aplicando memoization – versión 2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#principio-de-acceso-uniforme" class="md-nav__link">
    Principio de acceso uniforme
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejemplo-acceso-uniforme-en-c-version-3" class="md-nav__link">
    Ejemplo: acceso uniforme en C# – versión 3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejemplo-acceso-uniforme-en-scala" class="md-nav__link">
    Ejemplo: acceso uniforme en Scala
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#duplicacion-por-impaciencia" class="md-nav__link">
    Duplicación por impaciencia
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#duplicacion-por-simultaneidad" class="md-nav__link">
    Duplicación por simultaneidad
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ortogonalidad" class="md-nav__link">
    Ortogonalidad
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#beneficios-de-la-ortogonalidad" class="md-nav__link">
    Beneficios de la ortogonalidad
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mayor-productividad" class="md-nav__link">
    Mayor productividad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#menor-riesgo" class="md-nav__link">
    Menor riesgo
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#niveles-de-aplicacion-de-la-ortogonalizad" class="md-nav__link">
    Niveles de aplicación de la ortogonalizad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tecnicas-de-codificacion" class="md-nav__link">
    Técnicas de codificación
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#desacoplar-ley-de-demeter" class="md-nav__link">
    Desacoplar - ley de Demeter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inyectar-el-contexto" class="md-nav__link">
    Inyectar el contexto
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejemplo-patron-estrategia" class="md-nav__link">
    Ejemplo: patrón estrategia
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejemplo-caballeros-de-la-mesa-redonda" class="md-nav__link">
    Ejemplo: caballeros de la mesa redonda
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ley-de-demeter-para-funciones" class="md-nav__link">
    Ley de Demeter para funciones
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interfaces-fluent" class="md-nav__link">
    Interfaces fluent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#criticas-a-la-ley-de-demeter" class="md-nav__link">
    Críticas a la ley de Demeter
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejemplo-pintar-graficos-de-grabadoras" class="md-nav__link">
    Ejemplo: pintar gráficos de grabadoras
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#criticas" class="md-nav__link">
    Críticas
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ortogonalidad-en-toolkits-y-bibliotecas" class="md-nav__link">
    Ortogonalidad en toolkits y bibliotecas
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/sistemas-sw/construccion/edit/master/docs/iiss-oop-4.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h0>OBJETOS - Código duplicado</h0>
<p><a id="caso4"></a></p>
<h1 id="caso-4-calculo-de-nominas">Caso 4 - Cálculo de nóminas<a class="headerlink" href="#caso-4-calculo-de-nominas" title="Permanent link">&para;</a></h1>
<h2 id="codigo-duplicado">Código duplicado<a class="headerlink" href="#codigo-duplicado" title="Permanent link">&para;</a></h2>
<p><a id="nominas"></a></p>
<h3 id="implementacion-de-nominas-v01">Implementación de nóminas v0.1<a class="headerlink" href="#implementacion-de-nominas-v01" title="Permanent link">&para;</a></h3>
<details class="question"><summary>En la siguiente implementación, ¿dónde hay código duplicado?</summary><ul>
<li>Código duplicado en los constructores de las clases y subclases</li>
<li>Refactorizar delegando hacia la superclase</li>
</ul>
</details>
<div class="highlight"><pre><span></span><code>  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Empleado</span> <span class="p">{</span>
    <span class="n">Comparable</span> <span class="n">id</span><span class="p">;</span>
    <span class="n">String</span> <span class="n">name</span><span class="p">;</span>
    <span class="kd">public</span> <span class="nf">Empleado</span><span class="p">(</span><span class="n">String</span> <span class="n">id</span><span class="p">,</span> <span class="n">String</span> <span class="n">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">print</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">id</span><span class="o">+</span><span class="s">&quot; &quot;</span><span class="o">+</span><span class="n">name</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Autonomo</span> <span class="kd">extends</span> <span class="n">Empleado</span> <span class="p">{</span>
    <span class="n">String</span> <span class="n">vatCode</span><span class="p">;</span>
    <span class="kd">public</span> <span class="nf">Autonomo</span><span class="p">(</span><span class="n">String</span> <span class="n">id</span><span class="p">,</span> <span class="n">String</span> <span class="n">name</span><span class="p">,</span> <span class="n">String</span> <span class="n">vat</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">vatCode</span> <span class="o">=</span> <span class="n">vat</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">print</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">id</span><span class="o">+</span><span class="s">&quot; &quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s">&quot; &quot;</span><span class="o">+</span><span class="n">vatCode</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Prueba</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">Empleado</span> <span class="n">e</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Empleado</span><span class="p">(</span><span class="s">&quot;0001&quot;</span><span class="p">,</span><span class="s">&quot;Enrique&quot;</span><span class="p">);</span>
      <span class="n">Empleado</span> <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Autonomo</span><span class="p">(</span><span class="s">&quot;0002&quot;</span><span class="p">,</span><span class="s">&quot;Ana&quot;</span><span class="p">,</span><span class="s">&quot;12345-A&quot;</span><span class="p">);</span>
      <span class="n">e</span><span class="p">.</span><span class="na">print</span><span class="p">();</span>  
      <span class="n">a</span><span class="p">.</span><span class="na">print</span><span class="p">();</span>  
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div>

<h3 id="nominas-v02">Nóminas v0.2<a class="headerlink" href="#nominas-v02" title="Permanent link">&para;</a></h3>
<ul>
<li>Requisito: los trabajadores autónomos cobran por horas (no tienen un salario fijo bruto)</li>
<li>Incluimos el método <code>computeMonthlySalary</code> para el cálculo de la nómina mensual</li>
</ul>
<details class="question"><summary>¿Están descohesionadas las clases?</summary><ul>
<li>¿Todos los empleados deben tener un salario anual <code>yearlyGrossSalary</code> bruto? Los autónomos no...</li>
<li>El método de cálculo del salario está descohesionado</li>
</ul>
</details>
<div class="highlight"><pre><span></span><code>  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Empleado</span> <span class="p">{</span>
    <span class="n">Comparable</span> <span class="n">id</span><span class="p">;</span>
    <span class="n">String</span> <span class="n">name</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">yearlyGrossSalary</span><span class="p">;</span>
    <span class="kd">public</span> <span class="nf">Empleado</span><span class="p">(</span><span class="n">String</span> <span class="n">id</span><span class="p">,</span> <span class="n">String</span> <span class="n">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">setSalary</span><span class="p">(</span> <span class="kt">float</span> <span class="n">s</span> <span class="p">)</span> <span class="p">{</span> <span class="n">yearlyGrossSalary</span><span class="o">=</span><span class="n">s</span><span class="p">;</span> <span class="p">}</span>   
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">print</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">id</span><span class="o">+</span><span class="s">&quot; &quot;</span><span class="o">+</span><span class="n">name</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kd">public</span> <span class="kt">float</span> <span class="nf">computeMonthlySalary</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">yearlyGrossSalary</span><span class="o">/</span><span class="mi">12</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Autonomo</span> <span class="kd">extends</span> <span class="n">Empleado</span> <span class="p">{</span>
    <span class="n">String</span> <span class="n">vatCode</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">workingHours</span><span class="p">;</span>
    <span class="kd">public</span> <span class="nf">Autonomo</span><span class="p">(</span><span class="n">String</span> <span class="n">id</span><span class="p">,</span> <span class="n">String</span> <span class="n">name</span><span class="p">,</span> <span class="n">String</span> <span class="n">vat</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">name</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">vatCode</span> <span class="o">=</span> <span class="n">vat</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">workingHours</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">public</span> <span class="kt">float</span> <span class="nf">computeMonthlySalary</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">workingHours</span><span class="o">*</span><span class="n">Company</span><span class="p">.</span><span class="na">getHourlyRate</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">Company</span><span class="p">.</span><span class="na">getVatRate</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">print</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">.</span><span class="na">print</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="o">+</span><span class="n">vatCode</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Prueba</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">Empleado</span> <span class="n">e</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Empleado</span><span class="p">(</span><span class="s">&quot;0001&quot;</span><span class="p">,</span> <span class="s">&quot;Enrique&quot;</span><span class="p">);</span>
      <span class="n">Empleado</span> <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Autonomo</span><span class="p">(</span><span class="s">&quot;0001&quot;</span><span class="p">,</span> <span class="s">&quot;Ana&quot;</span><span class="p">,</span> <span class="s">&quot;12345-A&quot;</span><span class="p">);</span>
      <span class="n">e</span><span class="p">.</span><span class="na">print</span><span class="p">();</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
      <span class="n">a</span><span class="p">.</span><span class="na">print</span><span class="p">();</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div>

<h3 id="nominas-v03">Nóminas v0.3<a class="headerlink" href="#nominas-v03" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>  <span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Empleado</span> <span class="p">{</span>
    <span class="cm">/* ... */</span>
    <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">float</span> <span class="nf">computeMonthlySalary</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Plantilla</span> <span class="kd">extends</span> <span class="n">Empleado</span> <span class="p">{</span>
    <span class="kt">float</span> <span class="n">yearlyGrossSalary</span><span class="p">;</span>
    <span class="cm">/* ... */</span>
    <span class="kt">float</span> <span class="nf">setSalary</span><span class="p">(</span> <span class="kt">float</span> <span class="n">s</span> <span class="p">)</span> <span class="p">{</span> <span class="n">yearlyGrossSalary</span><span class="o">=</span><span class="n">s</span><span class="p">;</span> <span class="p">}</span>
    <span class="kd">public</span> <span class="kt">float</span> <span class="nf">computeMonthlySalary</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">yearlyGrossSalary</span><span class="o">/</span><span class="mi">12</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Autonomo</span> <span class="kd">extends</span> <span class="n">Empleado</span> <span class="p">{</span>
    <span class="n">String</span> <span class="n">vatCode</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">workingHours</span><span class="p">;</span>
    <span class="kd">public</span> <span class="nf">Autonomo</span><span class="p">(</span><span class="n">String</span> <span class="n">id</span><span class="p">,</span> <span class="n">String</span> <span class="n">name</span><span class="p">,</span> <span class="n">String</span> <span class="n">vat</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">name</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">vatCode</span> <span class="o">=</span> <span class="n">vat</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">workingHours</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addWorkingHours</span><span class="p">(</span><span class="kt">float</span> <span class="n">workingHours</span><span class="p">){</span>
      <span class="k">this</span><span class="p">.</span><span class="na">workingHours</span> <span class="o">+=</span> <span class="n">workingHours</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">public</span> <span class="kt">float</span> <span class="nf">computeMonthlySalary</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">workingHours</span><span class="o">*</span><span class="n">Company</span><span class="p">.</span><span class="na">getHourlyRate</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">Company</span><span class="p">.</span><span class="na">getVatRate</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">print</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">.</span><span class="na">print</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="o">+</span><span class="n">vatCode</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Prueba</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">Empleado</span> <span class="n">e</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Plantilla</span><span class="p">(</span><span class="s">&quot;0001&quot;</span><span class="p">,</span> <span class="s">&quot;Pepe&quot;</span><span class="p">);</span>
      <span class="n">e</span><span class="p">.</span><span class="na">setSalary</span><span class="p">(</span><span class="mf">25000.0</span><span class="p">);</span>
      <span class="n">Empleado</span> <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Autonomo</span><span class="p">(</span><span class="s">&quot;0001&quot;</span><span class="p">,</span> <span class="s">&quot;Ana&quot;</span><span class="p">,</span> <span class="s">&quot;12345-A&quot;</span><span class="p">);</span>
      <span class="n">a</span><span class="p">.</span><span class="na">addWorkingHours</span><span class="p">(</span><span class="mf">30.0</span><span class="p">);</span>
      <span class="n">e</span><span class="p">.</span><span class="na">print</span><span class="p">();</span> <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot; Salario: &quot;</span><span class="o">+</span><span class="n">e</span><span class="p">.</span><span class="na">computeMonthlySalary</span><span class="p">()</span><span class="o">+</span><span class="s">&quot; EUR&quot;</span><span class="p">);</span>
      <span class="n">a</span><span class="p">.</span><span class="na">print</span><span class="p">();</span> <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot; Salario: &quot;</span><span class="o">+</span><span class="n">a</span><span class="p">.</span><span class="na">computeMonthlySalary</span><span class="p">()</span><span class="o">+</span><span class="s">&quot; EUR&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div>

<p><a id="refactoring"></a></p>
<h2 id="refactoring"><span style="color:blue;">Refactoring</span><a class="headerlink" href="#refactoring" title="Permanent link">&para;</a></h2>
<p>Hacer <em>refactoring</em> es hacer pequeñas transformaciones en el código que mantienen el sistema funcional, sin añadir nuevas funcionalidades.</p>
<blockquote>
<p>Refactoring is a disciplined technique for restructuring an existing body of code, altering its internal structure without changing its external behavior</p>
<p>— <cite><a href="http://www.refactoring.com/">M. Fowler</a>, <a href="http://www.refactoring.com">www.refactoring.com</a></cite></p>
<p>A change made to the internal structure of the software to make it easier to understand and cheaper to modify without changing its observable behavior</p>
<p>– <cite><a href="../bibliografia/#refactoring">M. Fowler (2008): Refactoring...</a></cite></p>
</blockquote>
<div class="admonition info">
<p class="admonition-title">Lectura recomendada</p>
<p>Hunt &amp; Thomas. <a href="../bibliografia/#pragmatic">The Pragmatic Programmer</a>, 1999.
Capítulo: <em>Refactoring</em></p>
</div>
<h3 id="motivos-para-refactoring">Motivos para refactoring<a class="headerlink" href="#motivos-para-refactoring" title="Permanent link">&para;</a></h3>
<ul>
<li>Código duplicado</li>
<li>Rutinas demasiado largas</li>
<li>Bucles demasiado largos o demasiado anidados</li>
<li>Clases poco cohesionadas</li>
<li>Interfaz de una clase con un nivel de abstracción poco consistente</li>
<li>Demasiados parámetros en una lista de parámetros</li>
<li>Muchos cambios en una clase tienden a estar compartimentalizados (afectan solo a una parte)</li>
<li>Muchos cambios requieren modificaciones en paralelo a varias clases</li>
<li>Hay que cambiar jerarquías de herencia en paralelo</li>
<li>Hay que cambiar muchas sentencias <em>case</em> en paralelo</li>
<li>Etc.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Lectura recomendada</p>
<p>McConnell. <a href="../bibliografia/#codecomplete">Code Complete</a>, 2004.</p>
</div>
<details class="question"><summary>¿Cuál es la primera razón para hacer refactoring?</summary><ul>
<li><strong>Código duplicado</strong></li>
</ul>
</details>
<p><a id="duplcode"></a></p>
<h2 id="codigo-duplicado_1"><span style="color:blue;">Código duplicado</span><a class="headerlink" href="#codigo-duplicado_1" title="Permanent link">&para;</a></h2>
<div class="admonition info">
<p class="admonition-title">Lectura recomendada</p>
<p>Hunt &amp; Thomas. <a href="../bibliografia/#pragmatic">The Pragmatic Programmer</a>, 1999.
Capítulo <em>DRY—The Evils of Duplication</em></p>
</div>
<h3 id="por-que-no-duplicar">¿Por qué no duplicar?<a class="headerlink" href="#por-que-no-duplicar" title="Permanent link">&para;</a></h3>
<ul>
<li>Mantenimiento</li>
<li>Cambios (no sólo a nivel de código)</li>
<li>Trazabilidad</li>
</ul>
<h3 id="causas-de-la-duplicacion">Causas de la duplicación<a class="headerlink" href="#causas-de-la-duplicacion" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Impuesta</strong>: No hay elección</li>
<li><strong>Inadvertida</strong>: No me he dado cuenta</li>
<li><strong>Impaciencia</strong>: No puedo esperar</li>
<li><strong>Simultaneidad</strong>: Ha sido otro</li>
</ul>
<h3 id="principio-dry-dont-repeat-yourself"><span style="color:blue;">Principio DRY – <em>Don't Repeat Yourself!</em></span><a class="headerlink" href="#principio-dry-dont-repeat-yourself" title="Permanent link">&para;</a></h3>
<p>by <a href="../bibliografia/#pragmatic">Hunt &amp; Thomas (1999)</a></p>
<blockquote>
<p>Copy and paste is a design error</p>
<p>– <cite> McConnell (1998) </cite></p>
</blockquote>
<h3 id="duplicacion-impuesta">Duplicación impuesta<a class="headerlink" href="#duplicacion-impuesta" title="Permanent link">&para;</a></h3>
<p>La gestión del proyecto así nos lo exige. Algunos ejemplos:</p>
<ul>
<li>Representaciones múltiples de la información:<ul>
<li>varias implementaciones de un TAD que necesita guardar elementos de distintos tipos, cuando el lenguaje no permite genericidad</li>
<li>el esquema de una BD configurado en la BD y en el código fuente a través de un <a href="http://www.agiledata.org/essays/mappingObjects.html">ORM</a></li>
</ul>
</li>
<li>Documentación del código:<ul>
<li>código incrustado en javadocs</li>
</ul>
</li>
<li>Casos de prueba:<ul>
<li>pruebas unitarias con jUnit</li>
</ul>
</li>
<li>Características del lenguaje:<ul>
<li>C/C++ header files</li>
<li>IDL specs</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Cómo evitaba Java la duplicación en sus <em>containers</em></p>
<p>Cuando el lenguaje no tenía capacidad de usar tipos genéricos (hasta el JDK 1.4), podría aparecer la necesidad de duplicar código a la hora de implementar un TAD contenedor, pues habría que repetir todo el código de manejo del TAD para cada tipo de elemento contenido. Para evitarlo, Java usó un <em>workaround</em>: todas las clases en Java heredan de <code>Object</code>. Así una clase que implementara un TAD contenedor de elementos de otra clase, tan solo tenía que declarar los elementos contenidos de tipo <code>Object</code>. Más tarde (a partir del JDK 1.5) introdujo los tipos genéricos y ya no era necesario usar dicho <em>workaround</em> basado en <code>Object</code> para evitar la duplicación</p>
</div>
<h4 id="tecnicas-de-solucion">Técnicas de solución<a class="headerlink" href="#tecnicas-de-solucion" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Generadores de código</strong>: para evitar duplicar representaciones múltiples de la información</li>
<li>Herramientas de <strong>ingeniería inversa</strong>: para generar código a partir de un esquema de BD – v.g. <a href="https://jeddict.github.io/">jeddict</a> para crear clases JPA, visualizar y modificar BDs y automatizar la generación de código Java EE.</li>
<li><strong>Plantillas</strong>: Tipos genéricos del lenguaje (Java, C++, TypeScript, etc.) o mediante un motor de plantillas – v.g. <a href="http://velocity.apache.org/">Apache Velocity</a> template language (<a href="http://velocity.apache.org/engine/2.0/user-guide.html#velocity-template-language-vtl-an-introduction">VTL</a>)</li>
<li><strong>Metadatos</strong>: Anotaciones @ en Java, decoradores en TypeScript, etc.</li>
<li>Herramientas de <strong>documentación</strong> (v.g. <a href="http://asciidoctor.org/">asciidoctor</a>: <a href="http://asciidoctor.org/docs/asciidoc-syntax-quick-reference/#include-files">inclusión de ficheros</a> y <a href="http://asciidoctor.org/docs/asciidoc-syntax-quick-reference/#source-code">formateo de código fuente</a>).</li>
<li>Herramientas de <strong><a href="http://www.literateprogramming.com/">programación literaria</a></strong></li>
<li>Ayuda del <strong>IDE</strong></li>
<li>Herramientas de <em>property-based testing</em>, como <a href="https://pypi.org/project/hypothesis/">Hypothesis</a> (python), <a href="https://github.com/emil-e/rapidcheck">RapidCheck</a> (C++), <a href="https://jqwik.net/">jqwik</a>  (Java) o <a href="https://en.wikipedia.org/wiki/QuickCheck">QuickCheck</a> (originalmente para Haskell).</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Property-based testing</p>
<ul>
<li>¿Cómo reducir la duplicación de código al programar pruebas unitarias?</li>
<li>Ejemplo de property-based testing con <a href="https://pypi.org/project/hypothesis/">Hypothesis</a> en Python:
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">hypothesis</span> <span class="kn">import</span> <span class="n">given</span>
<span class="kn">import</span> <span class="nn">hypothesis.strategies</span> <span class="k">as</span> <span class="nn">some</span>

<span class="nd">@given</span><span class="p">(</span><span class="n">some</span><span class="o">.</span><span class="n">lists</span><span class="p">(</span><span class="n">some</span><span class="o">.</span><span class="n">integers</span><span class="p">()))</span>
<span class="k">def</span> <span class="nf">test_list_size_is_invariant_across_sorting</span><span class="p">(</span><span class="n">a_list</span><span class="p">):</span>
  <span class="n">original_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_list</span><span class="p">)</span>
  <span class="n">a_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
  <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_list</span><span class="p">)</span> <span class="o">==</span> <span class="n">original_length</span>

<span class="nd">@given</span><span class="p">(</span><span class="n">some</span><span class="o">.</span><span class="n">lists</span><span class="p">(</span><span class="n">some</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span>
<span class="k">def</span> <span class="nf">test_sorted_result_is_ordered</span><span class="p">(</span><span class="n">a_list</span><span class="p">):</span>
  <span class="n">a_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">a_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">a_list</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</code></pre></div></li>
<li>Leer el Consejo nº 71 del libro de <a href="../bibliografia/#pragmatic2">Hunt &amp; Thomas (2020)</a>.</li>
</ul>
</div>
<h3 id="duplicacion-inadvertida">Duplicación inadvertida<a class="headerlink" href="#duplicacion-inadvertida" title="Permanent link">&para;</a></h3>
<p>Normalmente tiene origen en un diseño inapropiado.</p>
<p>Fuente de numerosos problemas de integración.</p>
<h4 id="ejemplo-codigo-duplicado-version-1">Ejemplo: código duplicado – versión 1<a class="headerlink" href="#ejemplo-codigo-duplicado-version-1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Line</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="n">Point</span> <span class="n">start</span><span class="p">;</span>
    <span class="kd">public</span> <span class="n">Point</span> <span class="n">end</span><span class="p">;</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="n">length</span><span class="p">;</span>
  <span class="p">}</span>
</code></pre></div>

<p><span style="color:red;">¿Dónde está la duplicación?</span></p>
<p>Realmente <code>length</code> ya está definido con <code>start</code>y <code>end</code>. <span style="color:red;">¿Mejor así...?</span></p>
<div class="highlight"><pre><span></span><code>  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Line</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="n">Point</span> <span class="n">start</span><span class="p">;</span>
    <span class="kd">public</span> <span class="n">Point</span> <span class="n">end</span><span class="p">;</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">length</span><span class="p">()</span> <span class="p">{</span>
       <span class="k">return</span> <span class="n">start</span><span class="p">.</span><span class="na">distanceTo</span><span class="p">(</span><span class="n">end</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div>

<p><span style="color:red;">¿Es conveniente aplicar siempre DRY?</span></p>
<p>A veces se puede optar por violar DRY por razones de rendimiento.</p>
<h4 id="ejemplo-aplicando-memoization-version-2">Ejemplo: aplicando memoization – versión 2<a class="headerlink" href="#ejemplo-aplicando-memoization-version-2" title="Permanent link">&para;</a></h4>
<p><a href="https://en.wikipedia.org/wiki/Memoization"><em>Memoization</em></a>: cachear los resultados de cómputos costosos</p>
<div class="highlight"><pre><span></span><code>  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Line</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">changed</span><span class="p">;</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">length</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">Point</span> <span class="n">start</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">Point</span> <span class="n">end</span><span class="p">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setStart</span><span class="p">(</span><span class="n">Point</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span> <span class="n">start</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span> <span class="n">changed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="p">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEnd</span><span class="p">(</span><span class="n">Point</span> <span class="n">p</span><span class="p">)</span>   <span class="p">{</span> <span class="n">end</span>   <span class="o">=</span> <span class="n">p</span><span class="p">;</span> <span class="n">changed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="p">}</span>
    <span class="kd">public</span> <span class="n">Point</span> <span class="nf">getStart</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">start</span><span class="p">;</span> <span class="p">}</span>
    <span class="kd">public</span> <span class="n">Point</span> <span class="nf">getEnd</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">end</span><span class="p">;</span> <span class="p">}</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">getLength</span><span class="p">()</span> <span class="p">{</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">changed</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">length</span> <span class="o">=</span> <span class="n">start</span><span class="p">.</span><span class="na">distanceTo</span><span class="p">(</span><span class="n">end</span><span class="p">);</span>
          <span class="n">changed</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
       <span class="p">}</span>
       <span class="k">return</span> <span class="n">length</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div>

<p>La técnica de memoization es menos problemática si queda dentro de los límites de la clase/módulo.</p>
<p>Otras veces no merece la pena violar DRY por rendimiento: ¡las cachés y los optimizadores de código también hacen su labor!</p>
<h3 id="principio-de-acceso-uniforme"><span style="color:blue;">Principio de acceso uniforme</span><a class="headerlink" href="#principio-de-acceso-uniforme" title="Permanent link">&para;</a></h3>
<blockquote>
<p>All services offered by a module should be available through a uniform notation, which does not betray whether they are implemented through storage or through computation</p>
<p><cite><a href="../bibliografia/#meyer">B. Meyer</a></cite></p>
</blockquote>
<p>Conviene aplicar el principio de acceso uniforme para que sea más fácil añadir mejoras de rendimiento (v.g. caching)</p>
<h4 id="ejemplo-acceso-uniforme-en-c-version-3">Ejemplo: acceso uniforme en C# – versión 3<a class="headerlink" href="#ejemplo-acceso-uniforme-en-c-version-3" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">public</span> <span class="k">class</span> <span class="nc">Line</span> <span class="p">{</span>
  <span class="k">private</span> <span class="n">Point</span> <span class="n">Start</span><span class="p">;</span>
  <span class="k">private</span> <span class="n">Point</span> <span class="n">End</span><span class="p">;</span>
  <span class="k">private</span> <span class="kt">double</span> <span class="n">Length</span><span class="p">;</span>

  <span class="k">public</span> <span class="n">Point</span> <span class="n">Start</span> <span class="p">{</span>
    <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">Start</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">set</span> <span class="p">{</span> <span class="n">Start</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span> <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">public</span> <span class="n">Point</span> <span class="n">End</span> <span class="p">{</span>
    <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">End</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">set</span> <span class="p">{</span> <span class="n">Start</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span> <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">public</span> <span class="kt">double</span> <span class="n">Length</span> <span class="p">{</span>
    <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">Start</span><span class="p">.</span><span class="n">distanceTo</span><span class="p">(</span><span class="n">End</span><span class="p">);</span> <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h4 id="ejemplo-acceso-uniforme-en-scala">Ejemplo: acceso uniforme en Scala<a class="headerlink" href="#ejemplo-acceso-uniforme-en-scala" title="Permanent link">&para;</a></h4>
<p>Llamadas a métodos con paréntesis:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Complejo</span><span class="o">(</span><span class="n">real</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">imaginaria</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">re</span><span class="o">()</span> <span class="k">=</span> <span class="n">real</span>
  <span class="k">def</span> <span class="n">im</span><span class="o">()</span> <span class="k">=</span> <span class="n">imaginaria</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">toString</span><span class="o">()</span> <span class="k">=</span>
    <span class="s">&quot;&quot;</span> <span class="o">+</span> <span class="n">re</span><span class="o">()</span> <span class="o">+</span> <span class="o">(</span><span class="k">if</span> <span class="o">(</span><span class="n">im</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="s">&quot;&quot;</span> <span class="k">else</span> <span class="s">&quot;+&quot;</span><span class="o">)</span> <span class="o">+</span> <span class="n">im</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot;i&quot;</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">NumerosComplejos</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">main</span><span class="o">()</span> <span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">c</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Complejo</span><span class="o">(</span><span class="mf">1.2</span><span class="o">,</span> <span class="mf">3.4</span><span class="o">)</span>
    <span class="n">println</span><span class="o">(</span><span class="s">&quot;Número complejo: &quot;</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">toString</span><span class="o">())</span>
    <span class="n">println</span><span class="o">(</span><span class="s">&quot;Parte imaginaria: &quot;</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">im</span><span class="o">())</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>

<p>Llamadas a métodos sin paréntesis, igual que si fueran atributos:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Complejo</span><span class="o">(</span><span class="n">real</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">imaginaria</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">re</span> <span class="k">=</span> <span class="n">real</span>
  <span class="k">def</span> <span class="n">im</span> <span class="k">=</span> <span class="n">imaginaria</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">toString</span><span class="o">()</span> <span class="k">=</span>
    <span class="s">&quot;&quot;</span> <span class="o">+</span> <span class="n">re</span> <span class="o">+</span> <span class="o">(</span><span class="k">if</span> <span class="o">(</span><span class="n">im</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="s">&quot;&quot;</span> <span class="k">else</span> <span class="s">&quot;+&quot;</span><span class="o">)</span> <span class="o">+</span> <span class="n">im</span> <span class="o">+</span> <span class="s">&quot;i&quot;</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">NumerosComplejos</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">main</span><span class="o">()</span> <span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">c</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Complejo</span><span class="o">(</span><span class="mf">1.2</span><span class="o">,</span> <span class="mf">3.4</span><span class="o">)</span>
    <span class="n">println</span><span class="o">(</span><span class="s">&quot;Número complejo: &quot;</span> <span class="o">+</span> <span class="n">c</span><span class="o">)</span>
    <span class="n">println</span><span class="o">(</span><span class="s">&quot;Parte imaginaria: &quot;</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">im</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>

<h3 id="duplicacion-por-impaciencia">Duplicación por impaciencia<a class="headerlink" href="#duplicacion-por-impaciencia" title="Permanent link">&para;</a></h3>
<ul>
<li>Los peligros del <em>copy&amp;paste</em></li>
<li>"Vísteme despacio que tengo prisa" (<em>shortcuts make for long delays</em>). Ejemplos:<ul>
<li>Meter el <code>main</code> de Java en cualquier clase</li>
<li>Fiasco del año 2000</li>
</ul>
</li>
</ul>
<h3 id="duplicacion-por-simultaneidad">Duplicación por simultaneidad<a class="headerlink" href="#duplicacion-por-simultaneidad" title="Permanent link">&para;</a></h3>
<ul>
<li>No resoluble a nivel de técnicas de construcción</li>
<li>Hace falta metodología, gestión de equipos + herramientas de comunicación</li>
</ul>
<p><a id="ortogonalidad"></a></p>
<h2 id="ortogonalidad"><span style="color:blue;">Ortogonalidad</span><a class="headerlink" href="#ortogonalidad" title="Permanent link">&para;</a></h2>
<p>Dos componentes A y B son ortogonales (<span><span class="MathJax_Preview">A \perp B</span><script type="math/tex">A \perp B</script></span>) si los cambios en uno no afectan al otro. Suponen más independencia y menos acoplamiento. Por ejemplo:</p>
<ul>
<li>La base de datos debe ser ortogonal a la interfaz de usuario</li>
<li>En un helicóptero, los mandos de control no suelen ser ortogonales</li>
</ul>
<div class="admonition quote">
<p class="admonition-title">A Nonorthogonal System (<a href="../bibliografia/#pragmatic2">Hunt, 2020</a>)</p>
<p>Helicopters have four basic controls. The cyclic is the stick you hold in your right hand. Move it, and the helicopter moves in the corresponding direction. Your left hand holds the collective pitch lever. Pull up on this and you increase the pitch on all the blades, generating lift. At the end of the pitch lever is the throttle. Finally you have two foot pedals, which vary the amount of tail rotor thrust and so help turn the helicopter.</p>
<p>“Easy!,” you think. “Gently lower the collective pitch lever and you’ll descend gracefully to the ground, a hero.” However, when you try it, you discover that life isn’t that simple. The helicopter’s nose drops, and you start to spiral down to the left. Suddenly you discover that you’re flying a system where every control input has secondary effects. Lower the left-hand lever and you need to add compensating backward movement to the right-hand stick and push the right pedal. But then each of these changes affects all of the other controls again. Suddenly you’re juggling an unbelievably complex system, where every change impacts all the other inputs. Your workload is phenomenal: your hands and feet are constantly moving, trying to balance all the interacting forces.</p>
<p>Helicopter controls are decidedly not orthogonal.</p>
</div>
<h3 id="beneficios-de-la-ortogonalidad">Beneficios de la ortogonalidad<a class="headerlink" href="#beneficios-de-la-ortogonalidad" title="Permanent link">&para;</a></h3>
<h4 id="mayor-productividad">Mayor productividad<a class="headerlink" href="#mayor-productividad" title="Permanent link">&para;</a></h4>
<ul>
<li>Es más fácil escribir un componente pequeño y auto-contenido que un bloque muy grande de código. El tiempo de desarrollo y <strong>pruebas</strong> se reduce</li>
<li>Se pueden combinar unos componentes con otros más fácilmente. Mayor <strong>reutilización</strong>.</li>
<li>En teoría, si <span><span class="MathJax_Preview">A \perp B</span><script type="math/tex">A \perp B</script></span>, el componente A sirve para <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> propósitos y B sirve para <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span>, entonces <span><span class="MathJax_Preview">A \cup B</span><script type="math/tex">A \cup B</script></span> sirve para <span><span class="MathJax_Preview">m \times n</span><script type="math/tex">m \times n</script></span> propósitos.</li>
<li>La falta de cohesión perjudica la reutilización &rarr; ¿y si hay que hacer una nueva versión gráfica de una aplicación de línea de comandos que lleva incrustada la escritura en consola con <code>System.out.println</code>? Pueden descohesionar!</li>
</ul>
<h4 id="menor-riesgo">Menor riesgo<a class="headerlink" href="#menor-riesgo" title="Permanent link">&para;</a></h4>
<ul>
<li>Defectos aislados, más fáciles de arreglar</li>
<li>Menor <strong>fragilidad</strong> del sistema global. Los problemas provocados por cambios en un área se limitan a ese área</li>
<li>Más fácil de <strong>probar</strong>, pues será más fácil construir pruebas individuales de cada uno de sus componentes (por ejemplo, las técnicas de <em><a href="https://en.wikipedia.org/wiki/Mock_object">mocking</a></em> son más sencillas)</li>
</ul>
<h3 id="niveles-de-aplicacion-de-la-ortogonalizad">Niveles de aplicación de la ortogonalizad<a class="headerlink" href="#niveles-de-aplicacion-de-la-ortogonalizad" title="Permanent link">&para;</a></h3>
<p>La ortogonalidad es aplicable a:</p>
<ul>
<li>el diseño</li>
<li>la codificación</li>
<li>las pruebas</li>
<li>bibliotecas</li>
<li>la documentación</li>
</ul>
<p>A nivel de <em>diseño</em>, los patrones de diseño y las arquitecturas como MVC facilitan la construcción de componentes ortogonales.</p>
<div class="admonition note">
<p class="admonition-title">Lectura recomendada</p>
<p>Leer el <a href="https://learning-oreilly-com.bibezproxy.uca.es/library/view/the-pragmatic-programmer/9780135956977/f_0028.xhtml#orthogonality">Topic 10: Orthogonality</a> de (<a href="../bibliografia/#pragmatic2">Hunt, 2020</a>).</p>
</div>
<h3 id="tecnicas-de-codificacion">Técnicas de codificación<a class="headerlink" href="#tecnicas-de-codificacion" title="Permanent link">&para;</a></h3>
<p>Técnicas de codificación para fomentar la ortogonalidad:</p>
<ul>
<li>Hacer <strong>refactoring</strong></li>
<li>Codificar <strong>patrones</strong> de diseño: strategy, template method, etc.</li>
<li>Evitar datos globales y <strong>singletons</strong>: ¿qué pasaría si hubiera que hacer una versión <em>multithreaded</em> de una aplicación?</li>
<li><strong>Inyectar</strong>: pasar explícitamente el contexto (dependencia) como parámetro a los constructores</li>
<li>Usar <strong>anotaciones</strong> (Java), decoradores (TypeScript) o atributos (C#)</li>
<li><strong>Desacoplar</strong>: Ley de <span><em>Demeter</em></span>—No hables con extraños</li>
<li>Usar programación orientada a <strong>aspectos</strong></li>
</ul>
<h4 id="desacoplar-ley-de-demeter">Desacoplar - ley de Demeter<a class="headerlink" href="#desacoplar-ley-de-demeter" title="Permanent link">&para;</a></h4>
<p>Al pedir un servicio a un objeto, el servicio debe ser realizado de parte nuestra, no que nos devuelva un tercero con el que tratar para realizarlo</p>
<p><strong>Ejemplo</strong>:</p>
<div class="highlight"><pre><span></span><code>  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">canWrite</span><span class="p">(</span><span class="n">User</span> <span class="n">user</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="na">isAnonymous</span><span class="p">())</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">user</span><span class="p">.</span><span class="na">getGroup</span><span class="p">().</span><span class="na">hasPermission</span><span class="p">(</span><span class="n">Permission</span><span class="p">.</span><span class="na">WRITE</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div>

<p>Refactorización: definir un método <code>User.hasPermission()</code></p>
<div class="admonition note">
<p class="admonition-title">Lectura recomendada</p>
<p>Leer el <a href="https://learning-oreilly-com.bibezproxy.uca.es/library/view/the-pragmatic-programmer/9780135956977/f_0049.xhtml#coupling">Topic 28: Decoupling</a> de (<a href="../bibliografia/#pragmatic2">Hunt, 2020</a>).</p>
</div>
<h4 id="inyectar-el-contexto">Inyectar el contexto<a class="headerlink" href="#inyectar-el-contexto" title="Permanent link">&para;</a></h4>
<p>Pasar explícitamente el contexto (dependencia) como parámetro a los constructores de la clase</p>
<h5 id="ejemplo-patron-estrategia">Ejemplo: patrón estrategia<a class="headerlink" href="#ejemplo-patron-estrategia" title="Permanent link">&para;</a></h5>
<p>En el patrón de diseño <em>strategy</em>, pasar el contexto a la estrategia en su creación</p>
<h5 id="ejemplo-caballeros-de-la-mesa-redonda">Ejemplo: caballeros de la mesa redonda<a class="headerlink" href="#ejemplo-caballeros-de-la-mesa-redonda" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Knight</span> <span class="p">{</span>
  <span class="n">Object</span> <span class="nf">embarkOnQuest</span><span class="p">()</span> <span class="kd">throws</span> <span class="n">QuestFailedException</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">KnightOfTheRoundTable</span> <span class="kd">implements</span> <span class="n">Knight</span> <span class="p">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="p">;</span>
  <span class="kd">private</span> <span class="n">Quest</span> <span class="n">quest</span><span class="p">;</span>
  <span class="kd">public</span> <span class="nf">KnightOfTheRoundTable</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">,</span> <span class="n">Quest</span> <span class="n">quest</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="na">quest</span> <span class="o">=</span> <span class="n">quest</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kd">public</span> <span class="n">Object</span> <span class="nf">embarkOnQuest</span><span class="p">()</span> <span class="kd">throws</span> <span class="n">QuestFailedException</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">quest</span><span class="p">.</span><span class="na">embark</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setQuest</span><span class="p">(</span><span class="n">Quest</span> <span class="n">quest</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="na">quest</span> <span class="o">=</span> <span class="n">quest</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Quest</span> <span class="p">{</span>
  <span class="kd">abstract</span> <span class="n">Object</span> <span class="nf">embark</span><span class="p">()</span>
    <span class="kd">throws</span> <span class="n">QuestFailedException</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4 id="ley-de-demeter-para-funciones">Ley de Demeter para funciones<a class="headerlink" href="#ley-de-demeter-para-funciones" title="Permanent link">&para;</a></h4>
<p>Los métodos de un objeto solo deben hacer llamadas a métodos...</p>
<ol>
<li><strong>propios</strong> </li>
<li>de objetos pasados como <strong>parámetros</strong></li>
<li>de objetos <strong>creados</strong> por ellos mismos</li>
<li>de objetos <strong>declarados</strong> en el mismo método</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="kd">class</span> <span class="nc">Demeter</span> <span class="p">{</span>
  <span class="kd">private</span> <span class="n">A</span> <span class="n">a</span><span class="p">;</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="nf">func</span><span class="p">();</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">example</span> <span class="p">(</span><span class="n">B</span> <span class="n">b</span><span class="p">);</span>

  <span class="kt">void</span> <span class="nf">example</span><span class="p">(</span><span class="n">B</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">C</span> <span class="n">c</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">f</span> <span class="o">=</span> <span class="n">func</span><span class="p">();</span>  <span class="c1">// (caso 1)</span>
    <span class="n">b</span><span class="p">.</span><span class="na">invert</span><span class="p">();</span>      <span class="c1">// (caso 2)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">A</span><span class="p">();</span>
    <span class="n">a</span><span class="p">.</span><span class="na">setActive</span><span class="p">();</span>   <span class="c1">// (caso 3)</span>
    <span class="n">c</span><span class="p">.</span><span class="na">print</span><span class="p">();</span>       <span class="c1">// (caso 4)</span>
<span class="p">}</span>
</code></pre></div>

<h4 id="interfaces-fluent">Interfaces <em>fluent</em><a class="headerlink" href="#interfaces-fluent" title="Permanent link">&para;</a></h4>
<div class="admonition warning">
<p class="admonition-title">Excepción a la ley de Demeter</p>
<p>Hay una excepción notable a la prohibición de encadenar llamadas a funciones de la ley de Demeter. Esta regla no aplica si es muy poco probable que haya cambios en las cosas que se encadenan. En la práctica, cualquier parte de tu aplicación debe considerarse como algo que es probable que cambie; cualquier elemento de una biblioteca de un tercero debe considerarse volátil, en particular si quienes mantienen dicha biblioteca suelen cambiar su API de una versión a otra.</p>
</div>
<p>Las librerías que vienen con el lenguaje suelen ser bastante estables, así que ejemplos de código como el siguiente son aceptables como excepción a esta interpretación de la ley de Demeter:</p>
<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">myList</span> <span class="o">=</span>
    <span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="s">&quot;a1&quot;</span><span class="p">,</span> <span class="s">&quot;a2&quot;</span><span class="p">,</span> <span class="s">&quot;b1&quot;</span><span class="p">,</span> <span class="s">&quot;c2&quot;</span><span class="p">,</span> <span class="s">&quot;c1&quot;</span><span class="p">);</span>

<span class="n">myList</span>
    <span class="p">.</span><span class="na">stream</span><span class="p">()</span>
    <span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">s</span> <span class="o">-&gt;</span> <span class="n">s</span><span class="p">.</span><span class="na">startsWith</span><span class="p">(</span><span class="s">&quot;c&quot;</span><span class="p">))</span>
    <span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">String</span><span class="p">::</span><span class="n">toUpperCase</span><span class="p">)</span>
    <span class="p">.</span><span class="na">sorted</span><span class="p">()</span>
    <span class="p">.</span><span class="na">forEach</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">::</span><span class="n">println</span><span class="p">);</span>
</code></pre></div>

<p>Los métodos <code>stream</code>, <code>filter</code>, <code>map</code>, <code>sorted</code> y <code>forEach</code> son parte de las nuevas <em>interfaces funcionales</em> para manejar <em>streams</em>, incorporadas a las colecciones (v.g. <code>List</code>) del lenguaje desde la versión Java 8. Este tipo de interfaces como la del API de streams de Java se conoce como <a href="https://en.wikipedia.org/wiki/Fluent_interface"><em>fluent interfaces</em></a>.</p>
<div class="admonition warning">
<p class="admonition-title">La programación con streams se tratará en el capítulo sobre <a href="../iiss-evp-1/">Programación basada en Eventos</a></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Las interfaces funcionales se tratarán en el capítulo sobre <a href="../iiss-fp-1/">Programación Funcional</a></p>
</div>
<h4 id="criticas-a-la-ley-de-demeter">Críticas a la ley de Demeter<a class="headerlink" href="#criticas-a-la-ley-de-demeter" title="Permanent link">&para;</a></h4>
<p>La ley de Demeter, ¿realmente ayuda a crear código más mantenible?</p>
<h5 id="ejemplo-pintar-graficos-de-grabadoras">Ejemplo: pintar gráficos de grabadoras<a class="headerlink" href="#ejemplo-pintar-graficos-de-grabadoras" title="Permanent link">&para;</a></h5>
<ul>
<li>Pintar un gráfico con los datos registrados por una serie de grabadoras (<code>Recorder</code>) dispersas por el mundo.</li>
<li>Cada grabadora está en una ubicación (<code>Location</code>), que tiene una zona horaria (<code>TimeZone</code>).</li>
<li>Los usuarios seleccionan (<code>Selection</code>) una grabadora y pintan sus datos etiquetados con la zona horaria correcta...</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">plotDate</span><span class="p">(</span><span class="n">Date</span> <span class="n">aDate</span><span class="p">,</span> <span class="n">Selection</span> <span class="n">aSelection</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">TimeZone</span> <span class="n">tz</span> <span class="o">=</span> <span class="n">aSelection</span><span class="p">.</span><span class="na">getRecorder</span><span class="p">().</span><span class="na">getLocation</span><span class="p">().</span><span class="na">getZone</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>

<h5 id="criticas">Críticas<a class="headerlink" href="#criticas" title="Permanent link">&para;</a></h5>
<ul>
<li>Multiplicidad de dependencias: <code>plotDate</code> <span><span class="MathJax_Preview">\dashrightarrow</span><script type="math/tex">\dashrightarrow</script></span> <code>Selection</code>, <code>Recorder</code>, <code>Location</code>, <code>TimeZone</code>.</li>
<li>Si cambia la implementación de <code>Location</code> de forma que ya no incluye directamente una <code>TimeZone</code>, hay que cambiar <code>plotDate</code></li>
<li>Añadir un método <em>delegado</em> <code>getTimeZone</code> a <code>Selection</code>. Así <code>plotDate</code> no se entera de si la <code>TimeZone</code> le llega desde <code>Recorder</code> o desde un objeto contenido en <code>Recorder</code>.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">plotDate</span><span class="p">(</span><span class="n">Date</span> <span class="n">aDate</span><span class="p">,</span> <span class="n">TimeZone</span> <span class="n">tz</span><span class="p">)</span> <span class="p">{</span>
  <span class="cm">/* ... */</span>
<span class="p">}</span>
<span class="n">plotDate</span><span class="p">(</span><span class="n">someDate</span><span class="p">,</span> <span class="n">someSelection</span><span class="p">.</span><span class="na">getTimeZone</span><span class="p">());</span>
</code></pre></div>

<p>Ahora <code>plotDate</code> <span><span class="MathJax_Preview">\dashrightarrow</span><script type="math/tex">\dashrightarrow</script></span> <code>Selection</code>, <code>TimeZone</code>, pero se han eliminado las restantes dependencias.</p>
<ul>
<li>Costes de espacio y ejecución de métodos <em>wrapper</em> que reenvían la petición al objeto delegado: violar la ley de Demeter para mejorar el <strong>rendimiento</strong></li>
<li>Otros ejemplos de mejora del rendimiento: desnormalización de BBDD</li>
</ul>
<h3 id="ortogonalidad-en-toolkits-y-bibliotecas">Ortogonalidad en toolkits y bibliotecas<a class="headerlink" href="#ortogonalidad-en-toolkits-y-bibliotecas" title="Permanent link">&para;</a></h3>
<p>Muchas bibliotecas actuales implementan la ortogonalidad a través de metadatos, o atributos o etiquetas (@ <em>tag</em>), también llamados <a href="../iiss-oop-3/#dependencias-en-java">anotaciones</a> en Java y <a href="../iiss-oop-3/#decoradores-en-typescript">decoradores</a> en TypeScript.</p>
<p>Los metadatos se emplean para proporcionar propósitos específicos, como v.g. persistencia de objetos, transacciones, etc. Por ejemplo, Spring o EJB utilizan anotaciones @ declarativas para expresar la transaccionalidad de una operación o la persistencia de una propiedad de una clase fuera del método que debe ejecutar dichas funcionalidades.</p>
<p>Otro método para implementar la ortogonalidad es usar <a href="../iiss-aop/">Aspectos</a> y <em>Aspect-Oriented Programming</em> (AOP). Este método es empleado por el framework Spring.</p>
<div class="admonition warning">
<p class="admonition-title">Estudiar ahora el capítulo <a href="../iiss-aop/">Aspectos</a></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Estudiar luego el capítulo <a href="../iiss-err/">Calidad</a></p>
</div>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../iiss-oop-3/" title="Inyección" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Inyección
              </span>
            </div>
          </a>
        
        
          <a href="../iiss-err/" title="Calidad" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Calidad
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/dodero" target="_blank" rel="noopener" title="" class="md-footer-social__link fa fa-"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>